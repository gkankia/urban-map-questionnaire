<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Urbanyx</title>

    <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>    
 
    <!--fonts-->
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">        
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@100..900&display=swap" rel="stylesheet">

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'JetBrains Mono', monospace; color: #404040; }
        .map-container { display: flex; height: 100vh; flex-direction: row; }
        #map { flex: 1; order: 1 }
        .sidebar { order:0; width: 420px; overflow-y: auto; background: #f4f4f4; border-left: 1px solid #ddd; padding: 20px; }
        h1 { font-size: 5rem; text-align: center; background: transparent; margin: 0; color: rgba(255, 255, 255, 0.25); -webkit-text-stroke: 1px #6c86cf; /* Add a 1px black stroke */}
        p.subtitle { font-family: "Noto Sans Georgian", sans-serif; font-size: 1.10rem; text-transform: uppercase; text-align: center; margin-bottom: 25px;}
        .section { margin-bottom: 18px; padding: 14px; background: #f4f4f4; border-radius: 5px; }
        .section h3 { font-size: 14px; margin-bottom: 10px; color: #333; }
        label { display: inline-block; margin: 10px; font-size: 13px; font-weight: bold; }
        select, input { width: 100%; padding: 8px; font-size: 13px; border: 1px solid #ddd; border-radius: 3px; font-family: inherit; }
        .toggle-group { display: flex; gap: 10px; justify-content: center; margin: 10px; }
        .toggle { flex: 1; padding: 10px; text-align: center; border-radius: 5px; cursor: pointer; transition: all 0.2s; font-size: 13px; }
        .toggle:hover { background: #f4f4f4; color: #810f7c; box-shadow: 4px 4px 0 #810f7c; transform: translate(-4px, -4px);}
        .toggle.active { background: rgb(21, 22, 27); color: #f4f4f4; box-shadow: 4px 4px 0 #810f7c; transform: translate(-4px, -4px);}
        .modal { font-family: JetBrains Mono, monospace; display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); }
        .modal-content { background: white; margin: 3% auto; padding: 25px; border-radius: 10px; max-width: 600px; max-height: 85vh; overflow-y: auto; } 
        .close { float: right; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa; }
        .close:hover { color: #000; }
        .question { margin: 15px 0; padding: 12px; background: #f4f4f4; border-left: 3px solid #6c86cf; }
        .question label { margin: 0 0 8px 0; }
        .radio-group label { display: flex; align-items: center; margin: 5px 0; font-weight: normal; }
        .radio-group input { width: auto; margin-right: 8px; }
        .results { background: #f4f4f4; padding: 15px; border-radius: 5px; margin-top: 15px; }
        .info-box { padding: 10px; background: #f4f4f4; border-radius: 3px; margin-bottom: 15px; font-size: 12px; line-height: 1.5; }
        .three-word-name { font-size: 16px; font-weight: bold; color: #bde7ff; margin: 5px 0; }
        .tab-buttons { display: flex; gap: 10px; justify-content: center; margin: 10px; }
        .tab-btn { font-family: JetBrains Mono, monospace; box-shadow: 0 0 20px 0 #d0e8fd; flex: 1; border: 1px black; border-radius: 5px; padding: 12px; background: #f4f4f4; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 13px; }
        .tab-btn:hover { background: #f4f4f4; box-shadow: 4px 4px 0 #810f7c; /* Add box shadow on hover */ transform: translate(-4px, -4px); /* Adjust hover effect */}
        .tab-btn.active { color: white; background: rgb(21, 22, 27); box-shadow: 4px 4px 0 #810f7c; /* Add box shadow on hover */ transform: translate(-4px, -4px); /* Adjust hover effect */ }
        button.send { width: 100%; padding: 10px; background: #f4f4f4; color: #810f7c; border: none; border-radius: 5px; font-size: 14px; font-weight: bold; cursor: pointer; margin-top: 8px; }
        button.send:hover { background: #f4f4f4; box-shadow: 4px 4px 0 #810f7c; transform: translate(-4px, -4px) }
        .tab-content { display: none; }
        #timeResults { appearance: none; margin-left: 25px; display: inline-block; width: 15%; height: 50px; font-size: 14px; border: thin solid rgb(194, 194, 247); border-radius: 2px; box-shadow: 0 0 20px 0 #d0e8fd; text-align-last: center; padding-left: 5px; }
        .tab-content.active { display: block; }
        .aggregate-stat { padding: 8px; margin: 5px 0; background: #f4f4f4; border-radius: 3px; }
        .zaxis { display: block; position: fixed; bottom: 5px; right: 10px; z-index: 10; }
        
        @media (max-width: 768px) {
            .map-container { flex-direction: column; }
            .sidebar { width: 100%; border-left: none; border-top: 1px solid #ddd; height: 50vh; }
            #map { height: 50vh; }
        }
        
    </style>
</head>
<body>
    <!-- Questionnaire Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 style="text-align: center; margin-bottom: 15px;">კითხვარი</h2>
            <div id="cellInfo" class="info-box"></div>
            
            <form id="surveyForm">
                <div class="question">
                    <label>1. რა ასაკის ხართ?</label>
                    <select name="age" required>
                        <option value="">აირჩიეთ...</option>
                        <option value="18-25">18-25</option>
                        <option value="26-35">26-35</option>
                        <option value="36-45">36-45</option>
                        <option value="46-55">46-55</option>
                        <option value="56+">56+</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>2. სქესი:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="gender" value="male" required> მამრობითი</label>
                        <label><input type="radio" name="gender" value="female"> მდედრობითი</label>
                        <label><input type="radio" name="gender" value="other"> სხვა</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>3. რომელ პარტიას მისცემთ ხმას?</label>
                    <select name="vote" required>
                        <option value="">აირჩიეთ...</option>
                        <option value="qocebi">ქართული ოცნება</option>
                        <option value="lelo">ლელო</option>
                        <option value="gakharia">გახარია</option>
                        <option value="boycott">ბოიკოტი</option>
                        <option value="undecided">გადაუწყვეტელი</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>4. ეკონომიკის შეფასება:</label>
                    <select name="economy" required>
                        <option value="">აირჩიეთ...</option>
                        <option value="very_good">ძალიან კარგი</option>
                        <option value="good">კარგი</option>
                        <option value="neutral">საშუალო</option>
                        <option value="bad">ცუდი</option>
                        <option value="very_bad">ძალიან ცუდი</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>5. მთავარი პრიორიტეტი:</label>
                    <select name="priority" required>
                        <option value="">აირჩიეთ...</option>
                        <option value="economy">ეკონომიკა</option>
                        <option value="democracy">დემოკრატია</option>
                        <option value="eu">ევროინტეგრაცია</option>
                        <option value="security">უსაფრთხოება</option>
                        <option value="education">განათლება</option>
                    </select>
                </div>
                
                <button class="send" type="submit">გაგზავნა</button>
            </form>
        </div>
    </div>

    <div class="map-container">
        
        <div id="map">
            <footer>
                <div class="zaxis">
                    <a href="https://zaxis.ge"><img src="https://raw.githubusercontent.com/axis-Z/urbanyxv1/refs/heads/main/img/white-transparent-background.png" alt="" width="75"></a>
                </div>
            </footer>
        </div>
        
        <div class="sidebar">
            <div class="title">
                <h1>URBANYX</h1>
                <!-- <p class="subtitle">ურბანული ანალიტიკის პლატფორმა</p>-->
            </div>

            <!-- Tab Navigation -->
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('survey')">კითხვარი</button>
                <button class="tab-btn" onclick="switchTab('results')">შედეგები</button>
            </div>
            
            <!-- Survey Tab -->
            <div id="surveyTab" class="tab-content active">
                <div class="section">
                    <h3>ინსტრუქცია</h3>
                    <p style="font-size: 12px; line-height: 1.6;">
                        • დააკლიკე 200m x 200m grid უჯრედზე (ლურჯი კვადრატები)<br>
                        • თითოეულ უჯრედს აქვს უნიკალური სამი სიტყვიანი სახელი<br>
                        • შეავსე კითხვარი<br>
                        • პასუხები ავტომატურად ინახება Google Sheets-ში
                    </p>
                    <!--<div style="font-size: 11px; margin-top: 10px; padding: 8px; background: #f5f5f5; border-radius: 3px;">
                        <span class="status-indicator status-connected"></span>
                        <span>მზადაა მუშაობისთვის</span>
                    </div>-->
                </div>
                
                <!--<div class="section">
                    <h3>სტატისტიკა</h3>
                    <div id="dataStatus" style="font-size: 12px; line-height: 1.8;">
                        <div>📊 <strong>სულ პასუხი:</strong> <span id="totalResponses">0</span></div>
                        <div>🗺️ <strong>დაფარული უჯრედები:</strong> <span id="totalCells">0</span></div>
                    </div>
                </div>-->
            </div>
            
            <!-- Results Tab -->
            <div id="resultsTab" class="tab-content">
                <div class="section">
                    <h3>ანალიზის პარამეტრები</h3>
                    <p style="font-size: 12px; margin-bottom: 10px;">
                        დააკლიკე რუკაზე სასურველ წერტილზე იზოქრონის შესაქმნელად. ავტომატურად აგრეგირდება მონაცემები ყველა გადამკვეთი უჯრედიდან.
                    </p>
                    <label id="contours">გადაადგილების დრო (წუთი)</label>
                    <select id="timeResults">
                        <option value="10">10</option>
                        <option value="15" selected>15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                    </select>
                    
                    <label style="margin-top: 12px;">გადაადგილების ფორმა</label>
                    <div class="toggle-group">
                        <div class="toggle active" data-mode="walking" onclick="setResultsMode('walking')">ფეხით<br><span class="material-symbols-outlined">footprint</span></div>
                        <div class="toggle" data-mode="cycling" onclick="setResultsMode('cycling')">ველო<br><span class="material-symbols-outlined">directions_bike</span></div>
                    </div>
                </div>
                
                <div id="aggregateResults" class="results" style="display: none;">
                    <h3 style="margin-bottom: 12px;">აგრეგირებული შედეგები</h3>
                    <div id="aggregateContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="./main.js"></script>
</body>
</html>